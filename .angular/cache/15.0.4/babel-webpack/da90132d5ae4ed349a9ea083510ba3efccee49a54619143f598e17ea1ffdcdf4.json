{"ast":null,"code":"import { MAT_DIALOG_DATA } from '@angular/material/dialog';\nimport { UserPermission } from '../model/user-permission';\nimport { Utils } from '../core/utils';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../core/account.service\";\nimport * as i2 from \"@angular/material/dialog\";\nimport * as i3 from \"../core/project.service\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/material/form-field\";\nimport * as i6 from \"@angular/material/button\";\nimport * as i7 from \"@angular/material/select\";\nimport * as i8 from \"@angular/material/core\";\nfunction AddProjectUserDialogComponent_mat_option_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-option\", 13);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const user_r1 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", user_r1);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate2(\"\", user_r1.firstName, \" \", user_r1.lastName, \"\");\n  }\n}\nexport let AddProjectUserDialogComponent = /*#__PURE__*/(() => {\n  class AddProjectUserDialogComponent {\n    constructor(_accountService, _dialogRef, data, _projectService) {\n      this._accountService = _accountService;\n      this._dialogRef = _dialogRef;\n      this.data = data;\n      this._projectService = _projectService;\n      this.unassociatedUsers = [];\n      this.permission = 'View';\n      this.projectId = data.projectId;\n    }\n    ngOnInit() {\n      this, this._accountService.getAllUsers().subscribe(allUsers => {\n        this.allUsers = allUsers;\n        this._projectService.getProjectUsers(this.projectId).subscribe(projectUsers => {\n          this.allUsers.forEach(u => {\n            const projectUser = projectUsers.find(pu => pu.id === u.id);\n            if (!projectUser) {\n              this.unassociatedUsers.push(u);\n            }\n          });\n        });\n      });\n    }\n    add() {\n      if (!this.selectedUser) {\n        this.error = 'You must select a user to add';\n      } else {\n        const perm = new UserPermission();\n        perm.userProfileId = this.selectedUser.id;\n        perm.value = this.permission;\n        perm.projectId = this.projectId;\n        this._projectService.addUserPermission(perm).subscribe(result => {\n          this._dialogRef.close(true);\n        }, error => this.error = Utils.formatError(error));\n      }\n    }\n    cancel() {\n      this._dialogRef.close();\n    }\n  }\n  AddProjectUserDialogComponent.ɵfac = function AddProjectUserDialogComponent_Factory(t) {\n    return new (t || AddProjectUserDialogComponent)(i0.ɵɵdirectiveInject(i1.AccountService), i0.ɵɵdirectiveInject(i2.MatDialogRef), i0.ɵɵdirectiveInject(MAT_DIALOG_DATA), i0.ɵɵdirectiveInject(i3.ProjectService));\n  };\n  AddProjectUserDialogComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: AddProjectUserDialogComponent,\n    selectors: [[\"app-add-project-user-dialog\"]],\n    decls: 20,\n    vars: 4,\n    consts: [[\"mat-dialog-title\", \"\"], [\"mat-dialog-content\", \"\"], [2, \"width\", \"300px\"], [\"placeholder\", \"User\", \"required\", \"\", 3, \"value\", \"valueChange\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"placeholder\", \"Permission\", 3, \"value\", \"valueChange\"], [\"value\", \"View\"], [\"value\", \"Edit\"], [1, \"mat-body-1\", 2, \"color\", \"#E91E63\"], [\"mat-dialog-actions\", \"\", \"layout\", \"row\"], [\"mat-button\", \"\", \"color\", \"accent\", 3, \"click\"], [2, \"flex\", \"1 1 auto\"], [\"mat-button\", \"\", \"color\", \"primary\", 3, \"click\"], [3, \"value\"]],\n    template: function AddProjectUserDialogComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"h1\", 0);\n        i0.ɵɵtext(1, \"Add Project User\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(2, \"div\", 1)(3, \"mat-form-field\", 2)(4, \"mat-select\", 3);\n        i0.ɵɵlistener(\"valueChange\", function AddProjectUserDialogComponent_Template_mat_select_valueChange_4_listener($event) {\n          return ctx.selectedUser = $event;\n        });\n        i0.ɵɵtemplate(5, AddProjectUserDialogComponent_mat_option_5_Template, 2, 3, \"mat-option\", 4);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(6, \"mat-form-field\", 2)(7, \"mat-select\", 5);\n        i0.ɵɵlistener(\"valueChange\", function AddProjectUserDialogComponent_Template_mat_select_valueChange_7_listener($event) {\n          return ctx.permission = $event;\n        });\n        i0.ɵɵelementStart(8, \"mat-option\", 6);\n        i0.ɵɵtext(9, \"View\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(10, \"mat-option\", 7);\n        i0.ɵɵtext(11, \"Edit\");\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(12, \"div\", 8);\n        i0.ɵɵtext(13);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(14, \"div\", 9)(15, \"button\", 10);\n        i0.ɵɵlistener(\"click\", function AddProjectUserDialogComponent_Template_button_click_15_listener() {\n          return ctx.cancel();\n        });\n        i0.ɵɵtext(16, \"Cancel\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(17, \"span\", 11);\n        i0.ɵɵelementStart(18, \"button\", 12);\n        i0.ɵɵlistener(\"click\", function AddProjectUserDialogComponent_Template_button_click_18_listener() {\n          return ctx.add();\n        });\n        i0.ɵɵtext(19, \"Add\");\n        i0.ɵɵelementEnd()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"value\", ctx.selectedUser);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngForOf\", ctx.unassociatedUsers);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"value\", ctx.permission);\n        i0.ɵɵadvance(6);\n        i0.ɵɵtextInterpolate(ctx.error);\n      }\n    },\n    dependencies: [i4.NgForOf, i5.MatFormField, i2.MatDialogTitle, i2.MatDialogContent, i2.MatDialogActions, i6.MatButton, i7.MatSelect, i8.MatOption],\n    encapsulation: 2\n  });\n  return AddProjectUserDialogComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}